{"version":"6","defaultTimeframe":{"from":"now()-2h","to":"now()"},"defaultSegments":[],"sections":[{"id":"5e232538-5de0-4c08-bcde-a12faac9a0d2","type":"markdown","markdown":"# Let's analyze my \"Add to Cart\" logs"},{"id":"f86023d9-3458-45a5-8724-706d1b5b31e7","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n| filter contains(content, \"AddItemAsync\")","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"}},{"id":"d44826aa-5f69-4787-a31f-1e071e8cb9fb","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n|filter contains(content, \"AddItemAsync\")\n|filter k8s.namespace.name==\"prod\" AND k8s.deployment.name==\"cartservice-*\"","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"}},{"id":"07c1e1f2-5666-4334-b3e5-45b5e42649fe","type":"markdown","markdown":"# I want to extract the user, product, and quantity, but we didn't parse those on ingest"},{"id":"e7537123-1f4b-484b-b1f5-24534db9236b","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n|filter contains(content, \"AddItemAsync\")\n|filter k8s.namespace.name==\"prod\" AND k8s.deployment.name==\"cartservice-*\"\n|parse content, \"LD 'userId='LD:userId', productId='LD:ProductId', quantity='INT:ProductQuantity\"\n|fields ProductId, ProductQuantity, userId","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"}},{"id":"6ec52594-f071-454d-bdf3-8451fda94455","type":"markdown","markdown":"# Let's analyze the purchases"},{"id":"a57c2cb9-7dd2-4b0f-9065-720ba31b1319","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n|filter contains(content, \"AddItemAsync\")\n|filter k8s.namespace.name==\"prod\" AND k8s.deployment.name==\"cartservice-*\"\n|parse content, \"LD 'userId='LD:userId', productId='LD:ProductId', quantity='INT:ProductQuantity\"\n|fields content, ProductId, ProductQuantity, userId\n|summarize sum(ProductQuantity), alias:Quantity","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"},"title":"Total Product Purchases"},{"id":"d77f239c-7c23-4ba2-b398-7b95de9c7103","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n|filter contains(content, \"AddItemAsync\")\n|filter k8s.namespace.name==\"prod\" AND k8s.deployment.name==\"cartservice-*\"\n|parse content, \"LD 'userId='LD:userId', productId='LD:ProductId', quantity='INT:ProductQuantity\"\n|fields content, ProductId, ProductQuantity, userId\n|summarize sum(ProductQuantity), alias:Quantity, by: {ProductId}","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"},"title":"Purchases by Product Type"},{"id":"77630e9a-0ece-46e1-b4fb-130b718370fb","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n|filter contains(content, \"AddItemAsync\")\n|filter k8s.namespace.name==\"prod\" AND k8s.deployment.name==\"cartservice-*\"\n|parse content, \"LD 'userId='LD:userId', productId='LD:ProductId', quantity='INT:ProductQuantity\"\n|fields ProductQuantity, timestamp\n| makeTimeseries  sum(ProductQuantity)","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"},"title":"Total Product Purchases - Last 24 Hours"},{"id":"e712c6ff-a8fb-4a64-818e-ff9bb78565a1","type":"dql","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"value":"Fetch logs\n| filter contains(content, \"AddItemAsync\")\n| filter k8s.namespace.name==\"prod\" AND k8s.deployment.name==\"cartservice-*\"\n| parse content, \"LD 'userId='LD:userId', productId='LD:ProductId', quantity='DOUBLE:ProductQuantity\"\n| fields ProductQuantity, timestamp\n| makeTimeseries sum (ProductQuantity)\n| fields `sum(ProductQuantity)`, `interval`, `timeframe`","timeframe":{"from":"now()-2h","to":"now()"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualizationSettings":{"autoSelectVisualization":true},"state":"idle"}}]}